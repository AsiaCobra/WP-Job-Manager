jQuery(document).ready(function(e){function t(t,a){if(n){var i=t.find(".job_filters"),s=e(i).serialize(),r=e("div.job_listings").index(t);window.history.replaceState({id:"job_manager_state",page:a,data:s,index:r},"",o+"#s=1")}}var a=[];if(e(".job_listings").on("update_results",function(t,i,n,o){var s,r,l,d="",g=e(this),_=g.find(".job_filters"),c=g.find(".showing_jobs"),p=g.find(".job_listings"),h=g.data("per_page"),u=g.data("orderby"),f=g.data("order"),m=g.data("featured"),b=g.data("filled"),j=g.data("job_types"),w=g.data("post_status"),v=e("div.job_listings").index(this);if(!(v<0)){if(a[v]&&a[v].abort(),!0===g.data("show_filters")){var y=[];e(':input[name="filter_job_type[]"]:checked, :input[name="filter_job_type[]"][type="hidden"], :input[name="filter_job_type"]',_).each(function(){y.push(e(this).val())}),s=_.find(':input[name^="search_categories"]').map(function(){return e(this).val()}).get(),r="",l="";var k=_.find(':input[name="search_keywords"]'),x=_.find(':input[name="search_location"]');k.val()!==k.attr("placeholder")&&(r=k.val()),x.val()!==x.attr("placeholder")&&(l=x.val()),d={lang:job_manager_ajax_filters.lang,search_keywords:r,search_location:l,search_categories:s,filter_job_type:y,filter_post_status:w,per_page:h,orderby:u,order:f,page:i,featured:m,filled:b,show_pagination:g.data("show_pagination"),form_data:_.serialize()}}else s=g.data("categories"),r=g.data("keywords"),l=g.data("location"),s&&("string"!=typeof s&&(s=String(s)),s=s.split(",")),d={lang:job_manager_ajax_filters.lang,search_categories:s,search_keywords:r,search_location:l,filter_post_status:w,filter_job_type:j,per_page:h,orderby:u,order:f,page:i,featured:m,filled:b,show_pagination:g.data("show_pagination")};a[v]=e.ajax({type:"POST",url:job_manager_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:d,success:function(t){if(t)try{if(t.showing){var a=jQuery("<span>").html(t.showing);e(c).show().html("").html(t.showing_links).prepend(a)}else e(c).hide();t.showing_all?e(c).addClass("wp-job-manager-showing-all"):e(c).removeClass("wp-job-manager-showing-all"),t.html&&(n&&o?e(p).prepend(t.html):n?e(p).append(t.html):e(p).html(t.html)),!0===g.data("show_pagination")?(g.find(".job-manager-pagination").remove(),t.pagination&&g.append(t.pagination)):(!t.found_jobs||t.max_num_pages<=i?e(".load_more_jobs:not(.load_previous)",g).hide():o||e(".load_more_jobs",g).show(),e(".load_more_jobs",g).removeClass("loading"),e("li.job_listing",p).css("visibility","visible")),e(p).removeClass("loading"),g.triggerHandler("updated_results",t)}catch(e){window.console&&window.console.log(e)}},error:function(e,t,a){window.console&&"abort"!==t&&window.console.log(t+": "+a)},statusCode:{404:function(){window.console&&window.console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),e("#search_keywords, #search_location, .job_types :input, #search_categories, .job-manager-filter").change(function(){var a=e(this).closest("div.job_listings");a.triggerHandler("update_results",[1,!1]),t(a,1)}).on("keyup",function(t){13===t.which&&e(this).trigger("change")}),e(".job_filters").on("click",".reset",function(){var a=e(this).closest("div.job_listings"),i=e(this).closest("form");return i.find(':input[name="search_keywords"], :input[name="search_location"], .job-manager-filter').not(':input[type="hidden"]').val("").trigger("change.select2"),i.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val("").trigger("change.select2"),e(':input[name="filter_job_type[]"]',i).not(':input[type="hidden"]').attr("checked","checked"),a.triggerHandler("reset"),a.triggerHandler("update_results",[1,!1]),t(a,1),!1}).on("submit",function(){return!1}),e(document.body).on("click",".load_more_jobs",function(){var a=e(this).closest("div.job_listings"),i=parseInt(e(this).data("page")||1,10),n=!1;return e(this).addClass("loading"),e(this).is(".load_previous")?(n=!0,1===(i-=1)?e(this).remove():e(this).data("page",i)):(i+=1,e(this).data("page",i),t(a,i)),a.triggerHandler("update_results",[i,!0,n]),!1}),e("div.job_listings").on("click",".job-manager-pagination a",function(){var a=e(this).closest("div.job_listings"),i=e(this).data("page");return t(a,i),a.triggerHandler("update_results",[i,!1]),e("body, html").animate({scrollTop:a.offset().top},600),!1}),e.isFunction(e.fn.select2)&&"undefined"!=typeof job_manager_select2_args){var i=job_manager_select2_args;i.allowClear=!0,i.minimumResultsForSearch=10,e('select[name^="search_categories"]:visible').select2(i)}var n=!1;window.history&&window.history.pushState&&(n=!0);var o=document.location.href.split("#")[0];e(window).on("load",function(){e(".job_filters").each(function(){var t=e(this).closest("div.job_listings"),a=t.find(".job_filters"),i=1,n=e("div.job_listings").index(t);if(window.history.state&&window.location.hash){var o=window.history.state;o.id&&"job_manager_state"===o.id&&n===o.index&&(i=o.page,a.deserialize(o.data),a.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("change.select2"))}t.triggerHandler("update_results",[i,!1])})})});