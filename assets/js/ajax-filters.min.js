jQuery(document).ready(function(e){function t(t){return!!n()&&(!e(document.body).hasClass("disable-job-manager-form-state-storage")&&!t.data("disable-form-state-storage"))}function n(){return window.sessionStorage&&"function"==typeof window.sessionStorage.setItem}function i(t){var n=e("div.job_listings").index(t),i=t.data("post_id");return void 0!==i&&i||(i=window.location.href.replace(location.hash,"")),f+i+"_"+n}function a(e,n){if(!t(e))return!1;"object"!=typeof n&&(n={});var a=i(e);try{return window.sessionStorage.setItem(a,JSON.stringify(n))}catch(e){}return!1}function o(e){if(!t(e))return!1;var n=i(e);try{var a=window.sessionStorage.getItem(n);if(a)return JSON.parse(a)}catch(e){}return!1}function r(e,n){if(!t(e)||!e)return!1;var i=o(e);return!!i&&(i.persist_results=n,a(e,i))}function s(e){if(!t(e)||!e)return!1;var n=o(e);if(!n)return!1;var i=e.find(".job_filters");return n.form=i.serialize(),a(e,n)}function l(e,n){if(!t(e))return!1;var i=o(e);i||(i={persist_results:!1});var r=e.find(".job_listings");return n.html=r.html(),i.results=n,a(e,i)}function d(e){if(!t(e))return!1;var n=i(e);try{window.sessionStorage.removeItem(n)}catch(e){return!1}return!0}function c(e){if(!t(e))return!1;var n=o(e);return n||(n={}),n.results=null,a(e,n)}function u(e){if(!t(e))return!1;var n=o(e);return n||(n={}),n.form=null,a(e,n)}function g(e){var t=window.location.search,n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return n?decodeURIComponent(n[1]):null}function _(t,n,i){var a=t.find(".job_listings"),o=t.find(".showing_jobs");if("boolean"!=typeof i&&(i=!1),"string"==typeof n.showing&&n.showing){var r=jQuery("<span>").html(n.showing);o.show().html("").html(n.showing_links).prepend(r)}else o.hide();return n.showing_all?o.addClass("wp-job-manager-showing-all"):o.removeClass("wp-job-manager-showing-all"),n.html&&(i?a.append(n.html):a.html(n.html)),!0===t.data("show_pagination")?(t.find(".job-manager-pagination").remove(),n.pagination&&t.append(n.pagination)):(!n.found_jobs||n.max_num_pages<=n.data.page?e(".load_more_jobs:not(.load_previous)",t).hide():e(".load_more_jobs",t).show(),e(".load_more_jobs",t).removeClass("loading").data("page",n.data.page),e("li.job_listing",a).css("visibility","visible")),!0}var f="job_listing_";e(document).on("click","a",function(){e("div.job_listings").each(function(){s(e(this))})}),e(document).on("submit","form",function(){e("div.job_listings").each(function(){s(e(this))})});var p=[];if(e("div.job_listings").on("click","li.job_listing a",function(){r(e(this).closest("div.job_listings"),!0)}).on("click",".job-manager-pagination a",function(){var t=e(this).closest("div.job_listings"),n=e(this).data("page");return t.triggerHandler("update_results",[n,!1]),e("body, html").animate({scrollTop:t.offset().top},600),!1}).on("update_results",function(t,n,i){var a,o,r,s,c="",u=e(this),f=u.find(".job_filters"),h=u.find(".job_listings"),m=u.data("per_page"),b=u.data("orderby"),j=u.data("order"),v=u.data("featured"),w=u.data("filled"),y=u.data("job_types"),k=u.data("post_status"),x=e("div.job_listings").index(this);if(!(x<0)){if(d(u),p[x]&&p[x].abort(),i&&1!==n||(e("li.job_listing, li.no_job_listings_found",h).css("visibility","hidden"),h.addClass("loading")),u.find(".load_more_jobs").data("page",n),!0===u.data("show_filters")){var S=[];e(':input[name="filter_job_type[]"]:checked, :input[name="filter_job_type[]"][type="hidden"], :input[name="filter_job_type"]',f).each(function(){S.push(e(this).val())}),(a=f.find(':input[name^="search_categories"]').map(function(){return e(this).val()}).get())&&0!==a.length&&a[0]||(a=(o=g("search_category"))?o.split(","):a),r="",s="";var C=f.find(':input[name="search_keywords"]'),H=f.find(':input[name="search_location"]');C.val()!==C.attr("placeholder")&&(r=C.val()),H.val()!==H.attr("placeholder")&&(s=H.val()),c={lang:job_manager_ajax_filters.lang,search_keywords:r,search_location:s,search_categories:a,filter_job_type:S,filter_post_status:k,per_page:m,orderby:b,order:j,page:n,featured:v,filled:w,show_pagination:u.data("show_pagination"),form_data:f.serialize()}}else a=u.data("categories"),r=u.data("keywords"),s=u.data("location"),a&&("string"!=typeof a&&(a=String(a)),a=a.split(",")),c={lang:job_manager_ajax_filters.lang,search_categories:a,search_keywords:r,search_location:s,filter_post_status:k,filter_job_type:y,per_page:m,orderby:b,order:j,page:n,featured:v,filled:w,show_pagination:u.data("show_pagination")};p[x]=e.ajax({type:"POST",url:job_manager_ajax_filters.ajax_url.toString().replace("%%endpoint%%","get_listings"),data:c,success:function(e){if(e)try{e.data=c,_(u,e,i),h.removeClass("loading"),u.triggerHandler("updated_results",e),l(u,e)}catch(e){window.console&&window.console.log(e)}},error:function(e,t,n){window.console&&"abort"!==t&&window.console.log(t+": "+n)},statusCode:{404:function(){window.console&&window.console.log("Error 404: Ajax Endpoint cannot be reached. Go to Settings > Permalinks and save to resolve.")}}})}}),e("#search_keywords, #search_location, .job_types :input, #search_categories, .job-manager-filter").change(function(){var t=e(this).closest("div.job_listings");t.triggerHandler("update_results",[1,!1]),a(t)}).on("keyup",function(t){13===t.which&&e(this).trigger("change")}),e(".job_filters").on("click",".reset",function(){var t=e(this).closest("div.job_listings"),n=e(this).closest("form");return n.find(':input[name="search_keywords"], :input[name="search_location"], .job-manager-filter').not(':input[type="hidden"]').val("").trigger("change.select2"),n.find(':input[name^="search_categories"]').not(':input[type="hidden"]').val("").trigger("change.select2"),e(':input[name="filter_job_type[]"]',n).not(':input[type="hidden"]').attr("checked","checked"),t.triggerHandler("reset"),t.triggerHandler("update_results",[1,!1]),a(t),!1}).on("submit",function(){return!1}),e(document.body).on("click",".load_more_jobs",function(){var t=e(this).closest("div.job_listings"),n=parseInt(e(this).data("page")||1,10);return e(this).addClass("loading"),n+=1,e(this).data("page",n),t.triggerHandler("update_results",[n,!0]),!1}),e.isFunction(e.fn.select2)&&"undefined"!=typeof job_manager_select2_args){var h=job_manager_select2_args;h.allowClear=!0,h.minimumResultsForSearch=10,e('select[name^="search_categories"]:visible').select2(h)}e(window).on("load",function(){e("div.job_listings").each(function(){var t=e(this),n=t.find(".job_filters"),i=!1,a=o(t);a&&(a.results&&(i=_(t,a.results),r(t,!1),u(t)),"string"==typeof a.form&&""!==a.form&&(n.find("input[type=checkbox]").prop("checked",!1),n.deserialize(a.form),n.find(':input[name^="search_categories"]').not(':input[type="hidden"]').trigger("change.select2"))),!i&&n.length>0&&t.triggerHandler("update_results",[1,!1])})}),e(window).on("unload",function(){return e("div.job_listings").each(function(){var t=o(e(this));t&&!t.persist_results&&c(e(this))}),!0})});